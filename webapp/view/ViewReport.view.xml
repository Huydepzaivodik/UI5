<mvc:View xmlns:core="sap.ui.core"
  controllerName="bjmproject.controller.ViewReport"
	xmlns="sap.m"
	xmlns:mvc="sap.ui.core.mvc"
	xmlns:semantic="sap.f.semantic">

  <semantic:SemanticPage
    id="page"
    headerPinnable="true"
    toggleHeaderOnTitleClick="false"
    showFooter="true"
    >

    <semantic:titleHeading>
      <HBox alignItems="Center">
        <Image src="https://www.sap.com/dam/application/shared/logos/sap-logo-svg.svg" width="75px" />
        <Title text="{i18n>title}" />
      </HBox>
    </semantic:titleHeading>

    <semantic:headerContent>

      
    <VBox id="chartContainer" class="sapUiSmallMargin">

        <IconTabBar id="chartTabBar" select="onIconTabSelect" selectedKey="tab1" expandable="false">
          <items>
            <IconTabFilter key="tab1" text="Biểu đồ 1">
              <VBox>
                <core:HTML content="&lt;canvas id='barChart' width='100%' height='200'&gt;&lt;/canvas&gt;" />
              </VBox>
            </IconTabFilter>

            <IconTabFilter key="tab3" text="Biểu đồ OData mới">
              <VBox>
            <core:HTML content="&lt;canvas id='newBarChart' width='100%' height='200'&gt;&lt;/canvas&gt;" />
              </VBox>             
            </IconTabFilter>


            <IconTabFilter key="tab2" text="Biểu đồ 2">
              <VBox>
                <core:HTML content="&lt;canvas id='newChart' width='100%' height='200'&gt;&lt;/canvas&gt;" />
              </VBox>
            </IconTabFilter>
          </items>
        </IconTabBar>

      </VBox>


      <IconTabBar
        id="iconTabBar"
        select="onIconTabSelect"
        expandable="false">
        <items>
          <IconTabFilter
            id="allTab"
            key="All"
            showAll="true"
            count="{jobModel>/counts/All}"
            text="{i18n>FilterJobsAll}" />
        <IconTabSeparator />
        <IconTabFilter
            id="scheduledTab"
            key="Scheduled"
            icon="sap-icon://appointment"
            count="{jobModel>/counts/Scheduled}"
            text="Scheduled" />

        <IconTabFilter
            id="releasedTab"
            key="Released"
            icon="sap-icon://paper-plane"
            count="{jobModel>/counts/Released}"
            text="Released">
            <customData>
              <core:CustomData
                key="iconcolor"
                value="{= ${jobModel>/counts/Released} > 0 ? 'green' : 'gray' }"
                writeToDom="true" />
            </customData>
          </IconTabFilter>

        <IconTabFilter
            id="readyTab"
            key="Ready"
            icon="sap-icon://accept"
            count="{jobModel>/counts/Ready}"
            text="Ready" />

        <IconTabFilter
            id="activeTab"
            key="Active"
            icon="sap-icon://activity-items"
            count="{jobModel>/counts/Active}"
            text="Active" />

        <IconTabFilter
            id="runningTab"
            key="Running"
            icon="sap-icon://process"
            count="{jobModel>/counts/Running}"
            text="Running" />

        <IconTabFilter
            id="CanceledTab"
            key="Canceled"
            icon="sap-icon://decline"
            count="{jobModel>/counts/Canceled}"
            text="Canceled" />

        <IconTabFilter
            id="finishedTab"
            key="Finished"
            icon="sap-icon://complete"
            count="{jobModel>/counts/Finished}"
            text="Finished" />
          </items>
        <content>
        <VBox>
          <Table
            id="jobTable"
            items="{jobModel>/pagedData}"
            updateFinished="onUpdateFinished"
            class="sapUiSizeCompact"
            growing="true"
            growingScrollToLoad="true">
            <!-- Container cho các nút phân trang -->
          <!-- <HBox id="paginationContainer" justifyContent="Center" class="sapUiSmallMargin"/> -->
            <headerToolbar>
              <Toolbar id="jobTableToolbar">
                <HBox justifyContent="Start" alignItems="Center" width="100%"> <!-- Align title to the right of the logo -->
                  <Title
                    text="{
                      parts: [
                        { path: 'jobModel>/selectedTab' },
                        { path: 'jobModel>/counts' }
                      ],
                      formatter: '.formatter.dynamicTitle'
                    }"
                    level="H2">
                    <layoutData>
                      <FlexItemData styleClass="sapUiTinyMarginBegin" />
                    </layoutData>
                  </Title>
                </HBox>
                <ToolbarSpacer />
                <SearchField
                  id="searchField" 
                  placeholder="Search..."
                  liveChange="onSearch" />
                <Button text="Export" icon="sap-icon://download" press="onExport" />
              </Toolbar>
            </headerToolbar>

            <columns>
              <Column id="colId" width="8rem">
                <Text id="colIdHeader" text="ID" />
              </Column>
              <Column id="colJobname" width="20rem">
                <Text id="colJobnameHeader" text="Jobname" />
              </Column>
              <Column id="colJobcount" width="8rem">
                <Text id="colJobcountHeader" text="Jobcount" />
              </Column>
              <Column id="colStatus" width="10rem">
                <Text id="colStatusHeader" text="Status" />
              </Column>
              <Column id="colStrtdate" width="10rem">
                <Text id="colStrtdateHeader" text="Start Date" />
              </Column>
              <Column id="colEnddate" width="10rem">
                <Text id="colEnddateHeader" text="End Date" />
              </Column>
              <Column id="colAuthcknam" width="8rem">
                <Text id="colAuthcknamHeader" text="Authcknam" />
              </Column>
              <Column id="colDelay" width="10rem">
                <Text id="colDelayHeader" text="Delay" />
              </Column>             
            </columns>

            <items>
              <ColumnListItem press=".onPress" type="Navigation" id="jobRow">
                <cells>
                  <Text id="idText" text="{jobModel>Id}" />
                  <Text id="jobnameText" text="{jobModel>Jobname}" />
                  <Text id="jobcountText" text="{jobModel>Jobcount}" />
                  <!-- <Text id="statusText" text="{jobModel>Status}" /> -->
                  <HBox alignItems="Center" justifyContent="Start">
                    <core:Icon
                      src="{
                        path: 'jobModel>Status',
                        formatter: '.formatter.getStatusIcon'
                      }"
                      color="{
                        path: 'jobModel>Status',
                        formatter: '.formatter.getStatusColor'
                      }"
                      size="1.5rem"
                    />
                    <Text
                      text="{
                        path: 'jobModel>Status',
                        formatter: '.formatter.getStatusText'
                      }"
                      class="sapUiTinyMarginBegin"
                    />
                  </HBox>
                  <Text id="strtdateText" text="{path: 'jobModel>Strtdate'}" />
                  <Text id="enddateText" text="{path: 'jobModel>Enddate'}" />
                  <Text id="authcknamText" text="{jobModel>Authcknam}" />
                  <Text id="delayText" text="{jobModel>Delay}" />
                </cells>
              </ColumnListItem>
            </items>
          </Table>

          <!-- Thanh phân trang -->
        <OverflowToolbar class="sapUiTinyMarginTop">
          <ToolbarSpacer/>
          <HBox justifyContent="Center" alignItems="Center">
          <Button
            icon="sap-icon://slim-arrow-left"
            enabled="{= ${jobModel>/currentPage} > 1 }"
            press=".onPreviousPage"
            class="sapUiTinyMarginEnd"/>
      
         <Text 
            text="Page {jobModel>/currentPage} of {jobModel>/totalPages}"
            class="sapUiTinyMarginBeginEnd"/>

          <Button
            icon="sap-icon://slim-arrow-right"
            enabled="{= ${jobModel>/totalPages} > ${jobModel>/currentPage} }"
            press=".onNextPage"
            class="sapUiTinyMarginEnd"/>
      
            <!-- ... Giữ nguyên nút Previous/Next ... -->
          </HBox>
          <ToolbarSpacer/>
        </OverflowToolbar>

        <!-- Nút "Gửi báo cáo" đặt ở đây -->
        <OverflowToolbar class="sapUiTinyMarginTop">
          <ToolbarSpacer/>
          <Button
            icon="sap-icon://email"
            text="Gửi báo cáo"
            press="onShareEmailPress"/>
          <ToolbarSpacer/>
        </OverflowToolbar>
      </VBox>
        </content>
      </IconTabBar>
      
    </semantic:headerContent>

    <semantic:sendEmailAction>
      <semantic:SendEmailAction
        id="shareEmail"
        press="onShareEmailPress" />
    </semantic:sendEmailAction>





  </semantic:SemanticPage>
</mvc:View>
